# ファイル更新ルール（Git 運用）

このドキュメントは、**Cursor エージェントによるファイル更新が終わったあとの Git 運用**を定めます。教材の内容・構成のルール（`Doc/0-基本ルール.md`）とは別の、リポジトリの更新手順に関するルールです。

**このプロジェクトでは、Cursor エージェントは更新作業が終わったらかならずこのルールに従って commit と push を行う。**

---

## Cursor エージェント作業完了後の手順

Cursor のエージェントによる更新が**すべて終わったら**、次の手順を行う。

1. **変更点の概要をコミットメッセージに書く**  
   どのファイルをどう変更したか、短い概要をコミットメッセージに含める（例：「Lesson2 にコラム追加、解答例にコメント追加」「基本ルールにコラム・受講者像を追記」）。

2. **変更をステージに上げる**  
   すべての変更ファイルをステージングする。`git add .` を実行する。（コミット・push の前に必ず行う。）

3. **コミットする**  
   上記の概要をコミットメッセージに入れて `git commit` する。

4. **push する**  
   コミット後、`git push` を実行してリモート（GitHub など）に反映する。（下記の自動 push を入れていれば、コミットするだけで push まで行われる。）

- エージェントが複数ファイルを編集した場合は、**1回のコミット**に変更点の概要をまとめて書き、そのあと **1回の push** で送る。
- リポジトリは個人利用・バックアップ用途を想定しているため、作業完了ごとにすぐ commit と push してよい。

---

## 自動 push（Run を毎回押さないようにする）

- **エージェントが commit と push を実行する場合**  
  タスクの最後にエージェントが「変更をステージに上げる（`git add .`）」→「コミット（`git commit`）」→「push（`git push`）」の順で実行するので、**ユーザーが別途 Run を押す必要はありません**。エージェントがまとめて実行します。

- **コミット後に自動で push する**  
  リポジトリの `.git/hooks/post-commit` に「コミット後に `git push` を実行する」フックを入れてある。このため、**一度コミットすれば push まで自動で行われる**。`git push` を手動で実行する必要はない。

- **別の PC でクローンした場合**  
  `.git/hooks` はリポジトリに含まれないため、その PC で同じようにするには、`.git/hooks/post-commit` を新規作成し、中身を `#!/bin/sh` と `git push` の2行にして保存する（または `Doc/ファイル更新ルール.md` のこの節を参照して設定する）。

---

## Pushover 通知（push 完了後にスマホなどへ通知）

`main` ブランチへ push されると、GitHub Actions（`.github/workflows/notify-push.yml`）が動き、**Pushover** で「Push 完了」の通知を送る。

- **初回設定（1回だけ）**  
  1. [Pushover](https://pushover.net/) でアカウントを作成し、User Key を取得する。  
  2. Pushover の「Your Applications」でアプリを作成し、API Token を取得する。  
  3. GitHub のこのリポジトリ → **Settings** → **Secrets and variables** → **Actions** で、次のシークレットを追加する。  
     - `PUSHOVER_TOKEN`： 上記 API Token  
     - `PUSHOVER_USER`： 上記 User Key  

- 設定後は、push が完了するとワークフローが実行され、Pushover アプリに「JavaLesson - Push 完了」と通知が届く。
